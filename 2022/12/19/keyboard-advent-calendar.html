<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>2022年の振り返り | 年に一回のアドベントカレンダー投稿を置く場所</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="2022年の振り返り" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="今年作ったものを振り返ります" />
<meta property="og:description" content="今年作ったものを振り返ります" />
<link rel="canonical" href="/2022/12/19/keyboard-advent-calendar.html" />
<meta property="og:url" content="/2022/12/19/keyboard-advent-calendar.html" />
<meta property="og:site_name" content="年に一回のアドベントカレンダー投稿を置く場所" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-12-19T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="2022年の振り返り" />
<meta name="twitter:site" content="@_gonnoc" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"2022年の振り返り","dateModified":"2022-12-19T00:00:00+00:00","datePublished":"2022-12-19T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2022/12/19/keyboard-advent-calendar.html"},"description":"今年作ったものを振り返ります","url":"/2022/12/19/keyboard-advent-calendar.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="年に一回のアドベントカレンダー投稿を置く場所" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">年に一回のアドベントカレンダー投稿を置く場所</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">2022年の振り返り</h1>
    <p class="post-meta"><time class="dt-published" datetime="2022-12-19T00:00:00+00:00" itemprop="datePublished">
        Dec 19, 2022
      </time></p>
      <link rel="stylesheet" href="/assets/css/linkpreview.css">
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div id="share-bar" style="margin-top: 10px; margin-bottom: 10px;">
    <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button"
        data-show-count="false">Tweet</a>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button"
        data-hatena-bookmark-layout="basic-label-counter" data-hatena-bookmark-lang="ja"
        title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png"
            alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a>
    <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8"
        async="async"></script>
</div>
    <p><a href="https://adventar.org/calendars/7646">キーボード #2 Advent Calender 2022</a> 19日目担当のせきごんです。BLE Micro Proなど<a href="https://nogikes.booth.pm/">キーボード関連のモジュールを色々</a>作っています。</p>

<p>今年作ったものを振り返っていきます。</p>

<ul id="markdown-toc">
  <li><a href="#今年作ったもの" id="markdown-toc-今年作ったもの">今年作ったもの</a>    <ul>
      <li><a href="#静電容量式corne-corne-ec" id="markdown-toc-静電容量式corne-corne-ec">静電容量式Corne (Corne EC)</a></li>
      <li><a href="#静電容量スイッチスキャン用モジュール-254mmピッチ" id="markdown-toc-静電容量スイッチスキャン用モジュール-254mmピッチ">静電容量スイッチスキャン用モジュール (2.54mmピッチ)</a></li>
      <li><a href="#静電容量式キーボード用円錐バネ" id="markdown-toc-静電容量式キーボード用円錐バネ">静電容量式キーボード用円錐バネ</a></li>
      <li><a href="#4x4静電容量式キーボード" id="markdown-toc-4x4静電容量式キーボード">4x4静電容量式キーボード</a></li>
      <li><a href="#pseudobmp" id="markdown-toc-pseudobmp">PseudoBMP</a></li>
      <li><a href="#接続先os判別機構" id="markdown-toc-接続先os判別機構">接続先OS判別機構</a></li>
      <li><a href="#keyboard-quantizer-configurator" id="markdown-toc-keyboard-quantizer-configurator">Keyboard Quantizer Configurator</a></li>
      <li><a href="#玉太郎2仮" id="markdown-toc-玉太郎2仮">玉太郎2（仮）</a></li>
      <li><a href="#lulu-ec" id="markdown-toc-lulu-ec">lulu EC</a></li>
    </ul>
  </li>
</ul>

<h2 id="今年作ったもの">今年作ったもの</h2>

<h3 id="静電容量式corne-corne-ec">静電容量式Corne (Corne EC)</h3>

<p>XIAO RP2040と静電容量スイッチスキャン用モジュールを組み合わせた、Corneベースの静電容量式キーボードです。</p>

<div class="jekyll-linkpreview-wrapper">
    <div class="jekyll-linkpreview-wrapper-inner">
        <div class="jekyll-linkpreview-content">
            <div class=" jekyll-linkpreview-body">
                
                <div class="jekyll-linkpreview-image">
                    <a href="https://nogikes.booth.pm/items/2371017" target="_blank">
                        <img src="https://booth.pximg.net/c/620x620/9eb59d13-a644-4951-8279-08a5340df148/i/2371017/02993181-b374-4185-928a-79bca3fec3a0_base_resized.jpg" />
                    </a>
                </div>
                
                <h2 class="jekyll-linkpreview-title">
                    <a href="https://nogikes.booth.pm/items/2371017" target="_blank">Corne ECシリーズ 静電容量式自作キーボードキット - のぎけす屋 - BOOTH</a>
                </h2>
                <div class="jekyll-linkpreview-description">* 2023/6/30までに発送予定です * はんだ付けが必要なキットです * 写真は作例です。キースイッチ、キーキャップ、電池基板等は同梱されていません。 * 購入前にビルドガイドをご確認ください * ビットトレードワンの静電容量式スイッチのハウジングは適合しません https://github.com/sekigon-gonnoc/CorneECWL Corne ECシリーズはfoostan氏作のCorneシリーズをベースに、NIZ静電容量式スイッチに対応させた自作キーボードキットです。 Corne EC：静電容量式スイッチをスキャンするためのモジュールとXIAO</div>
            </div>
        </div>
    </div>
</div>

<h3 id="静電容量スイッチスキャン用モジュール-254mmピッチ">静電容量スイッチスキャン用モジュール (2.54mmピッチ)</h3>

<p>静電容量スイッチスキャン用モジュールも昨年のものから改版しています。<br />
昨年のモジュールは1.27mmピッチのピンヘッダで取り付けるタイプでしたが、はんだ付けが難しいという声もあったので2.54mmピッチのピンヘッダに変更しています。機能やサイズ感はそのままです。<br />
従来のモジュールを使用しているキットもあるので1.27mmピッチ版も継続します。</p>

<div class="jekyll-linkpreview-wrapper">
    <div class="jekyll-linkpreview-wrapper-inner">
        <div class="jekyll-linkpreview-content">
            <div class=" jekyll-linkpreview-body">
                
                <div class="jekyll-linkpreview-image">
                    <a href="https://nogikes.booth.pm/items/2710697" target="_blank">
                        <img src="https://booth.pximg.net/c/620x620/9eb59d13-a644-4951-8279-08a5340df148/i/2710697/47be4a7c-7b37-47a8-9322-f129eec5e22d_base_resized.jpg" />
                    </a>
                </div>
                
                <h2 class="jekyll-linkpreview-title">
                    <a href="https://nogikes.booth.pm/items/2710697" target="_blank">静電容量スイッチスキャン用モジュール - のぎけす屋 - BOOTH</a>
                </h2>
                <div class="jekyll-linkpreview-description">Pro Microなどのマイコンボードと組み合わせて静電容量式自作キーボードを作るためのモジュールです マルチプレクサとオペアンプを搭載していて、最大8つのスキャンラインを切り替えて電圧を出力できます 静電容量式自作キーボードの設計については下記資料等を参照してください https://nogikes.booth.pm/items/2373281 **仕様は予告なく変更される場合があります** ピンの説明や使い方はこのページを確認してください https://github.com/sekigon-gonnoc/ec-switch-scan-module</div>
            </div>
        </div>
    </div>
</div>

<h3 id="静電容量式キーボード用円錐バネ">静電容量式キーボード用円錐バネ</h3>

<p>静電容量式キーボードを自作するにはバネの入手性が悪いという問題があったので、バネを特注してみました。</p>

<div class="jekyll-linkpreview-wrapper">
    <div class="jekyll-linkpreview-wrapper-inner">
        <div class="jekyll-linkpreview-content">
            <div class=" jekyll-linkpreview-body">
                
                <div class="jekyll-linkpreview-image">
                    <a href="https://shop.yushakobo.jp/404" target="_blank">
                        <img src="https://cdn.shopify.com/s/files/1/0532/0880/9633/files/2000_1a8cb09e-7d61-4a25-ac99-1be2ea51051c.png?height=628&amp;pad_color=ffffff&amp;v=1663494255&amp;width=1200" />
                    </a>
                </div>
                
                <h2 class="jekyll-linkpreview-title">
                    <a href="https://shop.yushakobo.jp/404" target="_blank">404 Not Found</a>
                </h2>
                <div class="jekyll-linkpreview-description"></div>
            </div>
        </div>
    </div>
</div>

<p>最近はdeskeysも静電容量式キーボード用のバネを発売したらしいです。<br />
https://deskeys.io/products/des-ec-springs</p>

<h3 id="4x4静電容量式キーボード">4x4静電容量式キーボード</h3>

<p>金属ケースの静電容量式自作キーボードを作ってみました。<br />
後述のlulu ECの検証も兼ねています。</p>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">今年もテンキーを作りたくなる季節がやってきたということで。aliで4x4の金属ケースを買ってきてこれをこうしてこうじゃ（金属ケースの静電容量式自作キーボード <a href="https://t.co/dgVdoUsyLg">pic.twitter.com/dgVdoUsyLg</a></p>&mdash; せきごん (@_gonnoc) <a href="https://twitter.com/_gonnoc/status/1493510324439248896?ref_src=twsrc%5Etfw">February 15, 2022</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h3 id="pseudobmp">PseudoBMP</h3>

<p>BLE Micro Proのメイン部品が手に入らなさ過ぎて困ったので、BL652にUSB機能を外付けしてBLE Micro Proとして振る舞うようにしてみました。<br />
大体動くようになったタイミングでBLE Micro Proの部品が買えたので無事お蔵入りしました。</p>

<h3 id="接続先os判別機構">接続先OS判別機構</h3>

<p>キーボードをWindowsに繋いでいるときとMacに繋いでいるときで動作を変えたいという話を聞いたので、接続先OSの判別方法を考えてみました。</p>

<p>USB機器をホストに繋ぐと、OSがデバイスを認識するためのエニュメレーションというプロセスが発生します。このプロセスの手順がOSによって微妙に異なり、OSからのリクエストをチェックすることでWindowsかMacかLinuxか判別できます。</p>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">eeconfig(ledとかデフォルトレイヤとか)をOSごとに持てるようにしてみた。起動直後は前に繋いだOS向けの設定で立ち上がるけど、ホストにキーボードとして認識されるタイミングでそのOS向けの設定がロードされる感じが伝わるはず。SMKiJ有志の検証によるとMacもちゃんと認識するらしい <a href="https://t.co/b5rUTcnmZr">pic.twitter.com/b5rUTcnmZr</a></p>&mdash; せきごん (@_gonnoc) <a href="https://twitter.com/_gonnoc/status/1522845428416679936?ref_src=twsrc%5Etfw">May 7, 2022</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h3 id="keyboard-quantizer-configurator">Keyboard Quantizer Configurator</h3>

<p><a href="https://booth.pm/ja/items/2256612">Keyboard Quantizer</a>のファームウェアも地味に便利になってます。<br />
USキーボードをJIS設定のPCで使ったり、JISキーボードをUS設定のPCで使ったりしたいという要望に対応しました。先ほどのOS判別機構と合わせてブラウザから色々と設定できます。</p>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">Keyboard Quantizer rev4のファームウェアを更新しました。<br />USキーボードを日本語OSでいい感じにする（逆も）設定、<br />Remapからコンボを設定できるようにする小技、<br />接続先PCのOS種別判定、<br />接続先OSに紐づけた設定の保存、<br />これらをブラウザから設定するためのサイトなど<a href="https://t.co/YcLmxkpng0">https://t.co/YcLmxkpng0</a> <a href="https://t.co/arzLWwpfHD">pic.twitter.com/arzLWwpfHD</a></p>&mdash; せきごん (@_gonnoc) <a href="https://twitter.com/_gonnoc/status/1527906499695374336?ref_src=twsrc%5Etfw">May 21, 2022</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h3 id="玉太郎2仮">玉太郎2（仮）</h3>

<p>センサをボールの下に入れる構成はボール部分の背が高くなって目立つので、ダブルセンサにして高さを抑えました。無線化できるように電圧・電流が小さいセンサを採用しています。<br />
ボールホルダの設計が微妙なので要修正。</p>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">無線対応でダブルセンサで高さ抑えたやつ <a href="https://t.co/2W2h4Qx30o">pic.twitter.com/2W2h4Qx30o</a></p>&mdash; せきごん (@_gonnoc) <a href="https://twitter.com/_gonnoc/status/1545619043180093441?ref_src=twsrc%5Etfw">July 9, 2022</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h3 id="lulu-ec">lulu EC</h3>

<p>今年はGBというものに初めて参加してみました。<br />
普通に組むのはつまらないので静電容量スイッチに対応した基板を設計しています。</p>

<table>
  <thead>
    <tr>
      <th><img src="/assets/images/2022-12-18-16-52-00.jpg" alt="" /></th>
      <th><img src="/assets/images/2022-12-18-16-53-00.jpg" alt="" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>左手を仮組したところ</td>
      <td>構成はCorne ECと同じくXIAO RP2040+静電容量スイッチスキャンモジュール+NIZスイッチ</td>
    </tr>
  </tbody>
</table>

<p>この記事は玉太郎2(仮)で書きました。</p>

    <div id="share-bar" style="margin-top: 10px; margin-bottom: 10px;">
    <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button"
        data-show-count="false">Tweet</a>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button"
        data-hatena-bookmark-layout="basic-label-counter" data-hatena-bookmark-lang="ja"
        title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png"
            alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a>
    <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8"
        async="async"></script>
</div>
  </div><a class="u-url" href="/2022/12/19/keyboard-advent-calendar.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>年に一回のアドベントカレンダー投稿を置く場所</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/sekigon-gonnoc"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">sekigon-gonnoc</span></a></li><li><a href="https://www.twitter.com/_gonnoc"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">_gonnoc</span></a></li></ul>
</div>

  </div>

</footer>

</body>

</html>
